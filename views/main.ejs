<main class="main-content">
    <div class="container-fluid py-4">
        <%
            function getGreeting() {
                const now = new Date();
                const hour = now.getHours();
                if (hour >= 5 && hour < 12) {
                    return "Good Morning";
                } else if (hour >= 12 && hour < 17) {
                    return "Good Afternoon";
                } else if (hour >= 17 && hour < 21) {
                    return "Good Evening";
                } else {
                    return "Good Night";
                }
            }
        %>
        <div class="mb-4">
            <h2 class="fw-bold" id="greeting-text">
                <%= getGreeting() %>, welcome to SMATAJAYA Dashboard!
            </h2>
            <div class="text-muted" id="current-user-info"></div>
        </div>
        <script>
            fetch('/users/current-user')
              .then(res => res.json())
              .then(data => {
                if (data.email) {
                  document.getElementById('current-user-info').innerText = "Logged in as: " + data.email;
                }
              });
        </script>
        <div class="row g-4">
            <div class="col-xl-3 col-sm-6">
                <div class="card shadow-sm rounded-3">
                    <div class="card-body p-3">
                        <div class="row align-items-center">
                            <div class="col-12">
                                <div class="numbers">
                                    <p class="text-uppercase fw-bold text-secondary small mb-1">Today's Money</p>
                                    <h5 class="fw-bold mb-1"><%= totalMoney %></h5>
                                    <p class="mb-0">
                                        <span class="text-success fw-bold small">+55%</span>
                                        <span class="text-muted small">since yesterday</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-3 col-sm-6">
                <div class="card shadow-sm rounded-3">
                    <div class="card-body p-3">
                        <div class="row align-items-center">
                            <div class="col-12">
                                <div class="numbers">
                                    <p class="text-uppercase fw-bold text-secondary small mb-1">Users</p>
                                    <h5 class="fw-bold mb-1"><%= totalUsers %></h5>
                                    <p class="mb-0">
                                        <span class="text-success fw-bold small">+3%</span>
                                        <span class="text-muted small">since last week</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-3 col-sm-6">
                <div class="card shadow-sm rounded-3">
                    <div class="card-body p-3">
                        <div class="row align-items-center">
                            <div class="col-12">
                                <div class="numbers">
                                    <p class="text-uppercase fw-bold text-secondary small mb-1">Karyawan</p>
                                    <h5 class="fw-bold mb-1"><%= newClients %></h5>
                                    <p class="mb-0">
                                        <span class="text-danger fw-bold small">-2%</span>
                                        <span class="text-muted small">since last quarter</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-3 col-sm-6">
                <div class="card shadow-sm rounded-3">
                    <div class="card-body p-3">
                        <div class="row align-items-center">
                            <div class="col-12">
                                <div class="numbers">
                                    <p class="text-uppercase fw-bold text-secondary small mb-1">Task</p>
                                    <h5 class="fw-bold mb-1"><%= totalSales %></h5>
                                    <p class="mb-0">
                                        <span class="text-success fw-bold small">+5%</span>
                                        <span class="text-muted small">than last month</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row mt-4 g-4">
            <div class="col-lg-5">
                <div class="card overflow-hidden h-100 p-5 ">
                    <h5 class="fw-bold mb-4">Aksi Cepat</h5>
                    <div class="d-grid gap-3">
                        <a href="/staff" class="btn btn-primary"><i class="bi bi-people-fill text-lg px-2"></i> Tambah Karyawan</a>
                        <a href="/periode" class="btn btn-primary text-white"><i class="bi bi-calendar-day-fill text-lg px-2"></i>Tambah Instrumen</a>
                        <a href="/data" class="btn btn-primary text-white"><i class="bi bi-download text-lg px-2"></i> Export Data</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>